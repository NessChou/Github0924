using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;
using System.Data.SqlClient;
namespace ACME
{
    public partial class ACCStatistic : Form
    {
        public ACCStatistic()
        {
            InitializeComponent();
        }

        private void button19_Click(object sender, EventArgs e)
        {
            dataGridView8.DataSource = TT(comboBox7.Text);
            ExcelReport.GridViewToExcel(dataGridView8);
        }
        System.Data.DataTable TT(string DD)
        {
            SqlConnection MyConnection = globals.shipConnection;
            StringBuilder sb = new StringBuilder();
            sb.Append("                           Select LINE,部門,類型,[" + DD + "01],[" + DD + "02],[" + DD + "03],[" + DD + "04],[" + DD + "05],[" + DD + "06],[" + DD + "07],[" + DD + "08],[" + DD + "09],[" + DD + "10],[" + DD + "11],[" + DD + "12]");
            sb.Append("                           from (");
            sb.Append("                                                                SELECT 1 LINE,'TFT' 部門,'TFT Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                       LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                        ");
            sb.Append("                                        LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=103");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                                 SELECT 2 LINE,'LED Lighting','LED Lighting Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                       LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                        ");
            sb.Append("                                        LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=104");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                      UNION ALL");
            sb.Append("                               SELECT 3 LINE,'LED Chip Package','LED Chip Package Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                       LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                        ");
            sb.Append("                                        LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=115");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 4 LINE,'Solar','Solar Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                       LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=105");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 5 LINE,'ESCO','ESCO Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                       LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=106");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 6 LINE,'TFT','TFT Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=1032");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                     SELECT 7 LINE,'LED Lighting','LED Lighting Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=1033");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                     SELECT 8 LINE,'LED Chip Package','LED Chip Package Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=233");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 9 LINE,'Solar','Solar Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=102");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 10 LINE,'ESCO','ESCO Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=101");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                            SELECT 11 LINE,'TFT','TFT Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1032 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                        UNION ALL");
            sb.Append("                            SELECT 12 LINE,'LED Lighting','LED Lighting Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1033 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                    UNION ALL");
            sb.Append("                            SELECT 13 LINE,'LED Chip Package','LED Chip Package Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=233 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                      SELECT 14 LINE,'Solar','Solar Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=102 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                      SELECT 15 LINE,'ESCO','ESCO Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=101 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                          UNION ALL");
            sb.Append("                                                                SELECT 16 LINE,'TFT','TFT Lines of Delivery order-Warehouse' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                       LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=103");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                            UNION ALL");
            sb.Append("                                                                SELECT 17 LINE,'LED Lighting','LED Lighting Lines of Delivery order-Warehouse' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                       LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=104");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                          UNION ALL");
            sb.Append("                                                                SELECT 18 LINE,'LED Chip Package','LED Chip Package Lines of Delivery order-Warehouse' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                       LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=115");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 19 LINE,'Solar','Solar Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                       LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                         LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=105");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 20 LINE,'ESCO','ESCO Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                       LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                         LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=116");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 21 LINE,'TFT','TFT Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1032 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                           UNION ALL");
            sb.Append("                                                                SELECT 22 LINE,'LED Lighting','LED Lighting Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                      LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1033 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 23 LINE,'LED Chip Package','LED Chip Package Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                                 LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=233 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 24 LINE,'Solar','Solar Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                                LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=102 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 25 LINE,'ESCO','ESCO Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                                LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=101 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                 SELECT 26 LINE,'','Lines of Journal Voucher-shipping' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=30");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 27 LINE,'TFT','TFT Lines of AR Voucher-shipping' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                 LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                 LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE=103");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 28 LINE,'LED Lighting','LED Lighting Lines of AR Voucher-shipping' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                 LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                 LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE=104");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 29 LINE,'LED Chip Package','LED Chip Package Lines of AR Voucher-shipping' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                 LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                 LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE=115");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 30 LINE,'Solar','Solar Lines of AR Voucher-shipping' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                 LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                 LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE=105");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 31 LINE,'ESCO','ESCO Lines of AR Voucher-shipping' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                 LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                 LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE=116");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                                    SELECT 32 LINE,'TFT','TFT Lines of AP Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                        LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append(" LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18 AND T1.ITMSGRPCOD=1032");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                 UNION ALL");
            sb.Append("                                                                                    SELECT 33 LINE,'LED Lighting','LED Lighting Lines of AP Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                        LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append(" LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18 AND T1.ITMSGRPCOD=1033");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                 UNION ALL");
            sb.Append("                                                                                    SELECT 34 LINE,'LED Chip Package','LED Chip Package Lines of AP Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                        LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append(" LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18 AND T1.ITMSGRPCOD=233");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                 UNION ALL");
            sb.Append("                                                                                    SELECT 35 LINE,'Solar','Solar Lines of AP Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                        LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append(" LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18 AND T1.ITMSGRPCOD=102");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                 UNION ALL");
            sb.Append("                                                                                    SELECT 36 LINE,'ESCO','ESCO Lines of AP Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,6) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                        LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append(" LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                 WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18 AND T1.ITMSGRPCOD=101");
            sb.Append("                                                                 GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,6)");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 37 LINE,'TFT','TFT Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=103");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                 UNION ALL");
            sb.Append("                                                                 SELECT 38 LINE,'LED Lighting','LED Lighting Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=104");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 39 LINE,'LED Chip Package','LED Chip Package Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=115");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 40 LINE,'Solar','Solar Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=105");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 41 LINE,'ESCO','ESCO Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=116");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 42 LINE,'TFT','TFT Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=1032");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                    UNION ALL");
            sb.Append("                                                                SELECT 43 LINE,'LED Lighting','LED Lighting Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=1033");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                   UNION ALL");
            sb.Append("                                                                SELECT 44 LINE,'LED Chip Package','LED Chip Package Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=233");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 45 LINE,'Solar','Solar Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=102");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 46 LINE,'ESCO','ESCO Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD=101");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 47 LINE,'TFT','TFT Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1032 AND ITEMREMARK <> '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 48 LINE,'LED Lighting','LED Lighting Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1033 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 49 LINE,'LED Chip Package','LED Chip Package Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=233 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 50 LINE,'Solar','Solar Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=102 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 51 LINE,'ESCO','ESCO Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=101 AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 52 LINE,'TFT','TFT Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=103");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 53 LINE,'LED Lighting','LED Lighting Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=104");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 54 LINE,'LED Chip Package','LED Chip Package Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=115");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6) ");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 55 LINE,'Solar','Solar Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=105");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 56 LINE,'ESCO','ESCO Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,6) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE=116");
            sb.Append("                                                                GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 57 LINE,'TFT','TFT Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1032 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 58 LINE,'LED Lighting','LED Lighting Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=1033 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 59 LINE,'LED Chip Package','LED Chip Package Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=233 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 60 LINE,'Solar','Solar Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=102 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                                                                UNION ALL");
            sb.Append("                                                                SELECT 61 LINE,'ESCO','ESCO Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,6) 日期");
            sb.Append("                                                                ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD=101 AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,6)");
            sb.Append("                           ) T");
            sb.Append("                           PIVOT");
            sb.Append("                           (");
            sb.Append("                           AVG(筆數)");
            sb.Append("                           FOR 日期 IN");
            sb.Append("                           ( [" + DD + "01],[" + DD + "02],[" + DD + "03],[" + DD + "04],[" + DD + "05],[" + DD + "06],[" + DD + "07],[" + DD + "08],[" + DD + "09],[" + DD + "10],[" + DD + "11],[" + DD + "12] )");
            sb.Append("                           ) AS pvt");
            sb.Append("                           order by LINE");

            SqlCommand command = new SqlCommand(sb.ToString(), MyConnection);
            command.CommandType = CommandType.Text;



            SqlDataAdapter da = new SqlDataAdapter(command);
            DataSet ds = new DataSet();
            try
            {
                MyConnection.Open();
                da.Fill(ds, "wh_main");
            }
            finally
            {
                MyConnection.Close();
            }
            return ds.Tables["wh_main"];
        }
        System.Data.DataTable TT2()
        {
            SqlConnection MyConnection = globals.shipConnection;
            StringBuilder sb = new StringBuilder();
            sb.Append("                         SELECT * FROM (  SELECT 1 LINE,'TFT Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                              LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                        ");
            sb.Append("                               LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE  GROUPCODE=103");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 2 LINE,'LED Lighting Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                              LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                              LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=104");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append(" ");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 3 LINE,'LED Chip Package Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                              LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                              LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=115");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 4 LINE,'Solar Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                              LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                              LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=105");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 5 LINE,'ESCO Lines of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                              LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                              LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=116");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 6 LINE,'TFT Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                       left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1032");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 7 LINE,'LED Lighting Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                       left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1033");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("  UNION ALL");
            sb.Append("                                                       SELECT 8 LINE,'LED Chip Package Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                       left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=233");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 9 LINE,'Solar Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                       left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=102");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 10 LINE,'ESCO Lines of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                       left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=101");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 11 LINE,'TFT Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1032");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,10) BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 12 LINE,'LED Lighting Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE  T2.ITMSGRPCOD=1033");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                  UNION ALL");
            sb.Append("                                                       SELECT 13 LINE,'LED Chip Package Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE  T2.ITMSGRPCOD=233");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                             SELECT 14 LINE,'Solar Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=102");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                             SELECT 15 LINE,'ESCO Lines of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=101");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("               UNION ALL");
            sb.Append("                                                       SELECT 16 LINE,'TFT Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                              LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                              LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=103");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8)  BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 17 LINE,'LED Lighting Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                              LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=104");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("  UNION ALL");
            sb.Append("                                                       SELECT 18 LINE,'LED Chip Package Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                              LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=115");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 19 LINE,'Solar Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                              LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=105");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 20 LINE,'ESCO Lines of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                              LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=116");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 21 LINE,'TFT Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1032");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,10) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 22 LINE,'LED Lighting Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE  T2.ITMSGRPCOD=1033");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                    UNION ALL");
            sb.Append("                                                       SELECT 23 LINE,'LED Chip Package Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE  T2.ITMSGRPCOD=233");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                             SELECT 24 LINE,'Solar Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=102");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                             SELECT 25 LINE,'ESCO Lines of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                              LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                             LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=101");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                              UNION ALL");
            sb.Append("                                            SELECT 26 LINE,'Lines of Journal Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,8) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                       WHERE TRANSTYPE=30");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.REFDATE,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,8)");
            sb.Append("                                              UNION ALL");
            sb.Append("                                            SELECT 27 LINE,'Lines of AR Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,8) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                       WHERE TRANSTYPE=13");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.REFDATE,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,8)");
            sb.Append("                                              UNION ALL");
            sb.Append("                                            SELECT 28 LINE,'Lines of AP Voucher' 類型,Substring(Convert(varchar(8),t0.REFDATE,112),1,8) 日期,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                       WHERE TRANSTYPE=18 ");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.REFDATE,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.REFDate,112),1,8)");
            sb.Append("                                          UNION ALL");
            sb.Append("                                              SELECT 29 LINE,'TFT Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=103");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 30 LINE,'LED Lighting Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=104");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("  UNION ALL");
            sb.Append("                                                       SELECT 31 LINE,'LED Chip Package Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=115");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 32 LINE,'Solar Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=105");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 33 LINE,'ESCO Number of Sales Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=116");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 34 LINE,'TFT Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                       left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                       GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1032");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8)  BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 35 LINE,'LED Lighting Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                       left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                       GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1033");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append(" UNION ALL");
            sb.Append("                                                       SELECT 36 LINE,'LED Chip Package Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                       left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                       GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=233");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 37 LINE,'Solar Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                       left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                       GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=102");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 38 LINE,'ESCO Number of Purchase Order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                       left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                       GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=101");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 39 LINE,'TFT Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE  T2.ITMSGRPCOD=1032");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 40 LINE,'LED Lighting Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK  ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1033");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8)  BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append(" UNION ALL");
            sb.Append("                                                       SELECT 41 LINE,'LED Chip Package Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK  ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=233");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8)  BETWEEN @AA AND @BB AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 42 LINE,'Solar Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=102");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB  AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 43 LINE,'ESCO Number of job orders-Warehouse' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=101");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB  AND ITEMREMARK NOT IN ('銷售訂單','採購訂單')");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8) ");
            sb.Append("              union all");
            sb.Append("                                                       SELECT 44 LINE,'TFT Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=103");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 45 LINE,'LED Lighting Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE  GROUPCODE=104");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 46 LINE,'LED Chip Package Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE  GROUPCODE=115");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8) BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 47 LINE,'Solar Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=105");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8)  BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 48 LINE,'ESCO Number of Delivery order' 類型,Substring(Convert(varchar(8),t0.DocDate,112),1,8) 日期,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                       LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                       WHERE GROUPCODE=116");
            sb.Append("                                          AND Substring(Convert(varchar(8),t0.DocDate,112),1,8)  BETWEEN @AA AND @BB");
            sb.Append("                                                       GROUP BY Substring(Convert(varchar(8),t0.DocDate,112),1,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 49 LINE,'TFT Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1032");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 50 LINE,'LED Lighting Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=1033");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8)  BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("               UNION ALL");
            sb.Append("                                                       SELECT 51 LINE,'LED Chip Package Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=233");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8)  BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8)");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 52 LINE,'Solar Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=102");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8) ");
            sb.Append("                                                       UNION ALL");
            sb.Append("                                                       SELECT 53 LINE,'ESCO Number of job orders-shipping' 類型,SUBSTRING(T0.SHIPPINGCODE,3,8) 日期");
            sb.Append("                                                       ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                       LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                       left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                       GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                       WHERE T2.ITMSGRPCOD=101");
            sb.Append("                                          AND SUBSTRING(T0.SHIPPINGCODE,3,8) BETWEEN @AA AND @BB AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                       GROUP BY SUBSTRING(T0.SHIPPINGCODE,3,8) ");
            sb.Append("                                               ) AS A");
            SqlCommand command = new SqlCommand(sb.ToString(), MyConnection);
            command.CommandType = CommandType.Text;
            command.Parameters.Add(new SqlParameter("@AA", textBox1.Text));
            command.Parameters.Add(new SqlParameter("@BB", textBox2.Text));


            SqlDataAdapter da = new SqlDataAdapter(command);
            DataSet ds = new DataSet();
            try
            {
                MyConnection.Open();
                da.Fill(ds, "wh_main");
            }
            finally
            {
                MyConnection.Close();
            }
            return ds.Tables["wh_main"];
        }
        System.Data.DataTable TT3(string DD)
        {
            SqlConnection MyConnection = globals.shipConnection;
            StringBuilder sb = new StringBuilder();
            sb.Append("                                      Select LINE,類型,[TFT],[LED Lighting],[LED Chip Package],[Solar],[ESCO],[TOTAL]");
            sb.Append("                                      from (");
            sb.Append("                                                                           SELECT 1 LINE,");
            sb.Append(" CASE  GROUPCODE WHEN 103 THEN 'TFT' WHEN 104 THEN 'LED Lighting' WHEN 115 THEN 'LED Chip Package' WHEN 105 THEN 'Solar' WHEN 116 THEN 'ESCO' end 部門 ");
            sb.Append(" ,'Lines of Sales Order' 類型,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                  LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                        ");
            sb.Append("                                                   LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + "   AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append("                                                                           GROUP BY  GROUPCODE");
            sb.Append(" UNION ALL");
            sb.Append("                                       SELECT 1 LINE,");
            sb.Append(" 'TOTAL' 部門 ");
            sb.Append(" ,'Lines of Sales Order' 類型,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                  LEFT JOIN RDR1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                        ");
            sb.Append("                                                   LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + "  AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append(" UNION ALL");
            sb.Append("                           SELECT 2 LINE,CASE  T2.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar' WHEN 101 THEN 'ESCO' end 部門 ");
            sb.Append("                                                                           ,'Lines of Purchase Order' 類型,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                           LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                           left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                          GROUP BY  T2.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("                           SELECT 2 LINE,'TOTAL'部門 ,'Lines of Purchase Order' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                           LEFT JOIN POR1 T1 ON (T0.DOCENTRY=T1.DOCENTRY)");
            sb.Append("                                                                           left JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + "  AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append(" UNION ALL");
            sb.Append("                                       SELECT 3 LINE,CASE  T2.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar' WHEN 101 THEN 'ESCO' end 部門 ,'Lines of job orders-Warehouse' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                  LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                 LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + "  AND ITEMREMARK <> '銷售訂單' AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                           GROUP BY T2.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("  SELECT 3 LINE,'TOTAL' 部門 ,'Lines of job orders-Warehouse' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                  LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                 LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS ");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + "  AND ITEMREMARK <> '銷售訂單'  AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append(" UNION ALL");
            sb.Append("        SELECT 4 LINE,CASE  GROUPCODE WHEN 103 THEN 'TFT' WHEN 104 THEN 'LED Lighting' WHEN 115 THEN 'LED Chip Package' WHEN 105 THEN 'Solar' WHEN 116 THEN 'ESCO' end 部門 ,'Lines of Delivery order-Warehouse' 類型,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                  LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                                  LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + "  AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append("                                                                           GROUP BY GROUPCODE");
            sb.Append("         UNION ALL");
            sb.Append("        SELECT 4 LINE,'TOTAL' 部門 ,'Lines of Delivery order-Warehouse' 類型,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                  LEFT JOIN DLN1 T2 ON (T0.DOCENTRY=T2.DOCENTRY)                         ");
            sb.Append("                                                  LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + "  AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append(" UNION ALL                 ");
            sb.Append("  SELECT 5 LINE,CASE  T2.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar' WHEN 101 THEN 'ESCO' end 部門 ,'Lines of job orders-shipping' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                  LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                 LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + "  AND ITEMREMARK = '銷售訂單' AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                           GROUP BY T2.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("                   SELECT 5 LINE,'TOTAL' 部門 ,'Lines of job orders-shipping' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                  LEFT JOIN ACMESQLSP.DBO.SHIPPING_ITEM T1 ON (T0.SHIPPINGCODE=T1.SHIPPINGCODE)");
            sb.Append("                                                 LEFT JOIN OITM T2  ON T1.ITEMCODE = T2.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + "  AND ITEMREMARK = '銷售訂單' AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                             UNION ALL");
            sb.Append("        SELECT 6 LINE,CASE  GROUPCODE WHEN 103 THEN 'TFT' WHEN 104 THEN 'LED Lighting' WHEN 115 THEN 'LED Chip Package' WHEN 105 THEN 'Solar' WHEN 116 THEN 'ESCO' end 部門 ,'Lines of AR Voucher-shipping' 類型,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                            LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                            LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                            WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append("                                                                            GROUP BY GROUPCODE");
            sb.Append(" UNION ALL");
            sb.Append("        SELECT 6 LINE,'TOTAL' 部門 ,'Lines of AR Voucher-shipping' 類型,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                                                            LEFT JOIN OINV T1 ON (T0.BASEREF=T1.DOCENTRY) ");
            sb.Append("                                                                            LEFT JOIN OCRD T2 ON (T1.CARDCODE=T2.CARDCODE)");
            sb.Append("                                                                            WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=13 AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append(" UNION ALL          ");
            sb.Append("     SELECT 7 LINE,CASE  T1.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar' WHEN 101 THEN 'ESCO' end 部門 ,'Lines of AP Voucher' 類型,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                   LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append("            LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                            WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18  AND T1.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                            GROUP BY T1.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("               SELECT 7 LINE,'TOTAL' 部門 ,'Lines of AP Voucher' 類型,COUNT(*) 筆數 FROM OJDT T0");
            sb.Append("                                   LEFT JOIN (SELECT DISTINCT T0.DOCENTRY,T2.ITMSGRPCOD FROM PCH1 T0");
            sb.Append("            LEFT JOIN OITM T2  ON (T0.ITEMCODE = T2.ITEMCODE)) T1 ON (T0.BASEREF=T1.DOCENTRY)");
            sb.Append("                                                                            WHERE YEAR(t0.REFDate)=" + DD + " AND TRANSTYPE=18  AND T1.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append(" UNION ALL");
            sb.Append("   SELECT 8 LINE,CASE  GROUPCODE WHEN 103 THEN 'TFT' WHEN 104 THEN 'LED Lighting' WHEN 115 THEN 'LED Chip Package' WHEN 105 THEN 'Solar' WHEN 116 THEN 'ESCO' end 部門 ,'Number of Sales Order' 類型,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                           LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append("                                                                           GROUP BY GROUPCODE");
            sb.Append(" UNION ALL");
            sb.Append("   SELECT 8 LINE,'TOTAL' 部門 ,'Number of Sales Order' 類型,COUNT(*) 筆數 FROM ORDR T0");
            sb.Append("                                                                           LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + "  AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append(" UNION ALL");
            sb.Append("                SELECT 9 LINE,CASE  T2.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar' WHEN 101 THEN 'ESCO' end 部門 ,'Number of Purchase Order' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                           LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                           left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                           GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                           GROUP BY T2.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("                SELECT 9 LINE,'TOTAL' 部門 ,'Number of Purchase Order' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM OPOR T0");
            sb.Append("                                                                           LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.DOCENTRY FROM POR1 T1");
            sb.Append("                                                                           left JOIN OITM T11 ON T1.ITEMCODE = T11.ITEMCODE");
            sb.Append("                                                                           GROUP BY T1.DOCENTRY,T11.ITMSGRPCOD ) T2 ON (T0.DOCENTRY=T2.DOCENTRY)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + " AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                   UNION ALL");
            sb.Append("                   SELECT 10 LINE,CASE  T2.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar'  WHEN 101 THEN 'ESCO' end 部門,'Number of job orders-Warehouse' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                           LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                           left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + "  AND ITEMREMARK <> '銷售訂單' AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                           GROUP BY T2.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("                   SELECT 10 LINE,'TOTAL' 部門,'Number of job orders-Warehouse' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                           LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                           left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + "  AND ITEMREMARK <> '銷售訂單' AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101')");
            sb.Append("                                                                         UNION ALL");
            sb.Append("                                                                           SELECT 11 LINE,CASE  GROUPCODE WHEN 103 THEN 'TFT' WHEN 104 THEN 'LED Lighting' WHEN 115 THEN 'LED Chip Package' WHEN 105 THEN 'Solar' WHEN 116 THEN 'ESCO' end 部門 ,'Number of Delivery order' 類型,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                           LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append("                                                                           GROUP BY GROUPCODE");
            sb.Append(" UNION ALL");
            sb.Append("               SELECT 11 LINE,'TOTAL' 部門 ,'Number of Delivery order' 類型,COUNT(*) 筆數 FROM ODLN T0");
            sb.Append("                                                                           LEFT JOIN OCRD T1 ON (T0.CARDCODE=T1.CARDCODE)");
            sb.Append("                                                                           WHERE YEAR(t0.DocDate)=" + DD + " AND GROUPCODE IN ('103','105','115','105','116')");
            sb.Append(" UNION ALL");
            sb.Append("      SELECT 12 LINE,CASE  T2.ITMSGRPCOD WHEN 1032 THEN 'TFT' WHEN 1033 THEN 'LED Lighting' WHEN 233 THEN 'LED Chip Package' WHEN 102 THEN 'Solar' WHEN 101 THEN 'ESCO'  end 部門,'Number of job orders-shipping' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                           LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                           left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101') AND ITEMREMARK = '銷售訂單'");
            sb.Append("                                                                           GROUP BY T2.ITMSGRPCOD");
            sb.Append(" UNION ALL");
            sb.Append("      SELECT 12 LINE,'TOTAL' 部門,'Number of job orders-shipping' 類型");
            sb.Append("                                                                           ,COUNT(*) 筆數 FROM ACMESQLSP.DBO.SHIPPING_MAIN T0");
            sb.Append("                                                                           LEFT JOIN (SELECT DISTINCT T11.ITMSGRPCOD,T1.SHIPPINGCODE,T1.ITEMREMARK FROM ACMESQLSP.DBO.SHIPPING_ITEM T1");
            sb.Append("                                                                           left JOIN OITM T11  ON T1.ITEMCODE = T11.ITEMCODE COLLATE Chinese_Taiwan_Stroke_CI_AS");
            sb.Append("                                                                           GROUP BY T1.SHIPPINGCODE,T11.ITMSGRPCOD,T1.ITEMREMARK ) T2 ON (T0.SHIPPINGCODE=T2.SHIPPINGCODE)");
            sb.Append("                                                                           WHERE SUBSTRING(T0.SHIPPINGCODE,3,4)=" + DD + " AND T2.ITMSGRPCOD IN ('1032','1033','233','102','101') AND ITEMREMARK = '銷售訂單'");

            sb.Append("                                      ) T");
            sb.Append("                                      PIVOT");
            sb.Append("                                      (");
            sb.Append("                                      AVG(筆數)");
            sb.Append("                                      FOR 部門 IN");
            sb.Append("                                      ([TFT],[LED Lighting],[LED Chip Package],[Solar],[ESCO],[TOTAL])");
            sb.Append("                                      ) AS pvt");
            sb.Append("                                      order by LINE");

            SqlCommand command = new SqlCommand(sb.ToString(), MyConnection);
            command.CommandType = CommandType.Text;
            command.Parameters.Add(new SqlParameter("@AA", textBox1.Text));
            command.Parameters.Add(new SqlParameter("@BB", textBox2.Text));


            SqlDataAdapter da = new SqlDataAdapter(command);
            DataSet ds = new DataSet();
            try
            {
                MyConnection.Open();
                da.Fill(ds, "wh_main");
            }
            finally
            {
                MyConnection.Close();
            }
            return ds.Tables["wh_main"];
        }
        private void ACCStatistic_Load(object sender, EventArgs e)
        {
            UtilSimple.SetLookupBinding(comboBox7, GetMenu.Year(), "DataValue", "DataValue");

            textBox1.Text = GetMenu.DFirst();
            textBox2.Text = GetMenu.DLast();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            dataGridView8.DataSource = TT2();
            ExcelReport.GridViewToExcel(dataGridView8);
        }

        private void button2_Click(object sender, EventArgs e)
        {
            dataGridView8.DataSource = TT3(comboBox7.Text);
            ExcelReport.GridViewToExcel(dataGridView8);
        }
    }
}